<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping>

    <class name="sandbox.payroll.Employee">
        <id name="sandbox_payroll_IdentifiableTrait__id" type="java.lang.Long" access="field">
            <generator class="native"/>
        </id>

        <property name="name" type="java.lang.String" access="field"/>
        <property name="address" type="java.lang.String" access="field"/>
        <property name="email" type="java.lang.String" access="field"/>

        <one-to-one name="paymentType" class="sandbox.payroll.payment.type.GenericPaymentType" constrained="false"
                    lazy="false"/>
    </class>

    <class name="sandbox.payroll.payment.type.GenericPaymentType" >
        <id name="sandbox_payroll_IdentifiableTrait__id" type="java.lang.Long" access="field"/>

        <joined-subclass name="sandbox.payroll.payment.type.Monthly">
            <key column="sandbox_payroll_Identifiable__id" />
            <property name="salary" type="java.lang.Integer" access="field"/>
        </joined-subclass>

        <joined-subclass name="sandbox.payroll.payment.type.Hourly">
            <key column="sandbox_payroll_IdentifiableTrait__id"/>
            <property name="hourRate" type="java.lang.Integer" access="field"/>
            <set name="paymentAttachments" access="field" cascade="all,delete-orphan" inverse="false">
                <key column="paymentTypeId" not-null="true"/>
                <one-to-many class="sandbox.payroll.payment.attachment.TimeCard" />
            </set>
        </joined-subclass>

        <joined-subclass name="sandbox.payroll.payment.type.Commission">
            <key column="sandbox_payroll_IdentifiableTrait__id"/>
            <property name="commissionRate" type="java.lang.Integer" access="field"/>

            <set name="paymentAttachments" access="field" cascade="all,delete-orphan" inverse="false">
                <key column="paymentTypeId" not-null="true"/>
                <one-to-many class="sandbox.payroll.payment.attachment.SalesReceipt" />
            </set>
        </joined-subclass>
    </class>

    <class name="sandbox.payroll.payment.attachment.SalesReceipt">
        <id name="sandbox_payroll_IdentifiableTrait__id" type="java.lang.Long" access="field">
            <generator class="native"/>
        </id>

        <property name="date" type="org.jadira.usertype.dateandtime.joda.PersistentDateTime" access="field"/>
        <property name="amount" type="java.lang.Integer" access="field"/>
    </class>

    <class name="sandbox.payroll.payment.attachment.TimeCard">
        <id name="sandbox_payroll_IdentifiableTrait__id" type="java.lang.Long" access="field">
            <generator class="native"/>
        </id>

        <property name="date" type="org.jadira.usertype.dateandtime.joda.PersistentDateTime" access="field"/>
        <property name="hours" type="java.lang.Integer" access="field"/>
    </class>


</hibernate-mapping>