<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping>

    <class name="sandbox.payroll.Employee">
        <id name="id" access="field">
            <generator class="native"/>
        </id>
        <property name="name" type="java.lang.String" access="field"/>
        <property name="address" type="java.lang.String" access="field"/>
        <property name="email" type="java.lang.String" access="field"/>

        <many-to-one name="paymentData" class="sandbox.payroll.payment.GenericPaymentStyle" unique="true" not-null="true"
                     cascade="all,delete-orphan" lazy="false"/>
    </class>

    <class name="sandbox.payroll.payment.GenericPaymentStyle" >
        <id name="id" column="payment_id" access="field">
            <generator class="sequence"/>
        </id>

        <joined-subclass name="sandbox.payroll.payment.Monthly">
            <key column="payment_id"/>
            <property name="salary" type="java.lang.Integer" access="field"/>
        </joined-subclass>

        <joined-subclass name="sandbox.payroll.payment.Hourly">
            <key column="payment_id"/>
            <property name="hourRate" type="java.lang.Integer" access="field"/>
            <set name="paymentInfos" access="field" cascade="all,delete-orphan" inverse="false">
                <key column="payment_id" not-null="true"/>
                <one-to-many class="sandbox.payroll.payment.TimeCard" />
            </set>
        </joined-subclass>

        <joined-subclass name="sandbox.payroll.payment.Commission" extends="sandbox.payroll.payment.Hourly">
            <key column="payment_id"/>
            <property name="commissionRate" type="java.lang.Integer" access="field"/>

            <set name="paymentInfos" access="field" cascade="all,delete-orphan" inverse="false">
                <key column="payment_id" not-null="true"/>
                <one-to-many class="sandbox.payroll.payment.SalesReceipt" />
            </set>
        </joined-subclass>
    </class>

    <class name="sandbox.payroll.payment.SalesReceipt">
        <id name="id" access="field">
            <generator class="native"/>
        </id>
    </class>

    <class name="sandbox.payroll.payment.TimeCard">
        <id name="id" access="field">
            <generator class="native"/>
        </id>

        <property name="date" type="org.jadira.usertype.dateandtime.joda.PersistentDateTime" access="field"/>
        <property name="hours" type="java.lang.Integer" access="field"/>
    </class>


</hibernate-mapping>